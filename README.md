# Sprite Fusion Pixel Snapper

**Online version**: https://spritefusion.com/pixel-snapper

A tool to snap pixels to a perfect grid. Designed to fix messy and inconsistent pixel art generated by AI.

<img src="./static/hero.png" alt="Pixel Snapper" style="width: 100%; image-rendering: pixelated;">

## Why ?

**Current AI image models can't understand grid-based pixel art.**

- Pixel are inconsistent in size and position.
- The grid resolution can drift over time.
- Colors are not tied to a strict palette.

**With Pixel Snapper:**

- ‚úÖ Pixel are snapped to a perfect grid.
- ‚úÖ The grid resolution is consistent and can be scaled to pixel resolution.
- ‚úÖ Colors are tied to a strict, quantized palette.

## Perfect for

- **AI generated pixel art** that needs to be snapped to a grid.
- **Procedural 2D art that doesn't fit a grid** like tilemaps or isometric maps.
- **2D game assets and 3D textures** that need to be perfectly scalable.

<img src="./static/details.png" alt="Details" style="width: 100%; image-rendering: pixelated;">

<p align="center"><em>Pixel Snapper preserves as much details as possible like dithering.</em></p>

<br>

## Pixel Snapper comes in two flavors

Requires [Rust](https://www.rust-lang.org/) installed on your machine.

### üíª CLI Usage Guide

**Basic Single File:**
Process a single image, saving to a specific output filename.

```bash
cargo run --release -- input.png --output output.png
```

**Auto-Detection (Default):**
If you omit the color count, the tool automatically detects the optimal number of colors from the input image (up to 32).

```bash
cargo run --release -- input.bmp --output output.bmp
```

**Custom Palette:** üé®
Force the output to use a specific set of colors by providing a palette image. Pixels will be mapped to the nearest color in your palette (Euclidean distance).

```bash
cargo run --release -- input.png --output output.png --palette my_palette.png
```

**Batch Processing:** üì¶
Process an entire directory of assets. Supported formats: `png`, `jpg`, `bmp`, `gif`, `webp`, `tiff`.

```bash
# Process all images in assets/raw and save to assets/processed
cargo run --release -- assets/raw/ --output assets/processed/
```

**Manual Quantization:**
Specify a target number of colors (K-means clustering) for color reduction.

```bash
cargo run --release -- input.png output.png --k-colors 16
```

### üîç Verification & Limitations

**Dithering Preservation:**
Pixel Snapper is designed to respect dithering patterns. To verify this quantitatively:
1.  **Visual Inspection**: Check that dithered gradients remain smooth and don't clump into solid blocks.
2.  **Statistical Analysis**: Use tools like ImageMagick to compare the color distribution histogram of the input vs. output. The general shape should be preserved, even if specific values change.

**Artistic Limitations:**
-   **Gradients**: Smooth, non-dithered gradients with thousands of colors will be quantized into bands. This is expected behavior for pixel art.
-   **Off-Grid Elements**: "Sub-pixel" placement or anti-aliased edges used for artistic effect will be snapped to the nearest rigid grid cell, potentially altering the intended shape or "softness" of the object.

### üåê Web (WASM)

```bash
git clone https://github.com/Hugo-Dz/spritefusion-pixel-snapper.git
cd spritefusion-pixel-snapper
```

Build the WASM module:

```bash
wasm-pack build --target web --out-dir pkg --release
```

Then use the WASM module in your project.

## Acknowledgments

Pixel Snapper is a [Sprite Fusion](https://spritefusion.com) project. Sprite Fusion is a free, web-based tilemap editor for game developers supporting a wide range of engines including Unity, Godot, Defold, and GB Studio.

<img src="./static/spritefusion.webp" alt="Sprite Fusion" style="width: 100%;">

## License

MIT License [Hugo Duprez](https://www.hugoduprez.com/)